# üîå –ö–∞—Ç–∞–ª–æ–≥ API/–º–∞—Ä—à—Ä—É—Ç–æ–≤ - Sirius Group

## TL;DR
- **FastAPI backend** —Å —Ä–æ—É—Ç–µ—Ä–∞–º–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
- **Shop API** –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã –∏ –∑–∞–∫–∞–∑–æ–≤
- **Web —Ä–æ—É—Ç–µ—Ä—ã** –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –∞–¥–º–∏–Ω–∫–∏
- **QR-—Å–∫–∞–Ω–µ—Ä** –∏ —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
- **Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –Ω–∞ `/docs`

---

## üåê –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ—É—Ç–µ—Ä—ã

### **1. –ì–ª–∞–≤–Ω—ã–π —Ä–æ—É—Ç–µ—Ä (`app/main.py`)**

#### **–ü–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —Ä–æ—É—Ç–µ—Ä—ã:**
```python
app.include_router(web_public.router)           # –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
app.include_router(web_products.router)         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
app.include_router(web_orders.router)           # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
app.include_router(web_analytics.router)        # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ (prefix: /admin)
app.include_router(web_admin_panel.router)      # –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å
app.include_router(api.router)                  # API (prefix: /api)
app.include_router(web_shop.router)             # –ú–∞–≥–∞–∑–∏–Ω
app.include_router(shop_api.router)             # Shop API
app.include_router(shop_admin.router)           # –ê–¥–º–∏–Ω –º–∞–≥–∞–∑–∏–Ω–∞
app.include_router(qr_scanner.router)           # QR-—Å–∫–∞–Ω–µ—Ä
app.include_router(delivery_payment.router)     # –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
```

---

## üõçÔ∏è Shop API (`/api`)

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É**
- **–ú–µ—Ç–æ–¥**: `POST`
- **–ü—É—Ç—å**: `/api/shop/cart/add`
- **–§–∞–π–ª**: `app/routers/shop_api.py`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `product_id`, `quantity`
- **–û—Ç–≤–µ—Ç**: JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É (form data)**
- **–ú–µ—Ç–æ–¥**: `POST`
- **–ü—É—Ç—å**: `/api/shop/cart/add-form`
- **–§–∞–π–ª**: `app/routers/shop_api.py`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `Form(product_id)`, `Form(quantity)`
- **–û—Ç–≤–µ—Ç**: JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤

---

## üõí Web Shop (`/shop`)

### **–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/shop/`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `shop_catalog()`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–∞–ª–æ–≥–∞

### **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/shop/product/{product_id}`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `shop_product_detail()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `product_id: int`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞

### **–ö–æ—Ä–∑–∏–Ω–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/shop/cart`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `shop_cart()`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ—Ä–∑–∏–Ω—ã

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É (POST)**
- **–ú–µ—Ç–æ–¥**: `POST`
- **–ü—É—Ç—å**: `/shop/cart/add`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `add_to_cart_post()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `Form(product_id)`, `Form(quantity)`
- **–û—Ç–≤–µ—Ç**: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –∫–æ—Ä–∑–∏–Ω—É

### **–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/shop/checkout`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `shop_checkout()`
- **–û—Ç–≤–µ—Ç**: HTML —Ñ–æ—Ä–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫–∞–∑–∞**
- **–ú–µ—Ç–æ–¥**: `POST`
- **–ü—É—Ç—å**: `/shop/checkout`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `process_checkout()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `Form(customer_name)`
  - `Form(customer_phone)`
  - `Form(customer_city)`
  - `Form(delivery_option)`
  - `Form(delivery_city_other)`
  - `Form(payment_method_id)`
- **–û—Ç–≤–µ—Ç**: –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ø–µ—Ö–∞

### **–°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–∫–∞–∑–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/shop/order-success`
- **–§–∞–π–ª**: `app/routers/web_shop.py`
- **–§—É–Ω–∫—Ü–∏—è**: `order_success()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `Query(codes)` - –∫–æ–¥—ã –∑–∞–∫–∞–∑–æ–≤
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ø–µ—Ö–∞

---

## üöö –°–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏ (`/delivery`)

### **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/delivery/payment`
- **–§–∞–π–ª**: `app/routers/delivery_payment.py`
- **–§—É–Ω–∫—Ü–∏—è**: `delivery_payment_page()`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å WhatsApp –∫–Ω–æ–ø–∫–∞–º–∏

### **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ–ø–ª–∞—Ç—ã –¥–æ—Å—Ç–∞–≤–∫–∏ (—Å –∫–æ–¥–æ–º –∑–∞–∫–∞–∑–∞)**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/delivery/payment/{order_code}`
- **–§–∞–π–ª**: `app/routers/delivery_payment.py`
- **–§—É–Ω–∫—Ü–∏—è**: `delivery_payment_with_order()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `order_code: str`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–∫–∞–∑–µ

---

## üîç QR-—Å–∫–∞–Ω–µ—Ä –∏ –∑–∞–∫–∞–∑—ã

### **QR-—Å–∫–∞–Ω–µ—Ä**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/qr-scanner`
- **–§–∞–π–ª**: `app/routers/qr_scanner.py`
- **–§—É–Ω–∫—Ü–∏—è**: `qr_scanner_page()`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–∞–º–µ—Ä–æ–π

### **–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/orders/search`
- **–§–∞–π–ª**: `app/routers/web_orders.py`
- **–§—É–Ω–∫—Ü–∏—è**: `search_order()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `Query(code)`, `Query(phone)`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–∫–∞–∑–∞ –∏–ª–∏ —Ñ–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞

### **–î–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/orders/{order_code}`
- **–§–∞–π–ª**: `app/routers/web_orders.py`
- **–§—É–Ω–∫—Ü–∏—è**: `order_detail()`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: `order_code: str`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–∫–∞–∑–∞

---

## üè™ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è —á–∞—Å—Ç—å

### **–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/admin`
- **–§–∞–π–ª**: `app/routers/web_admin_panel.py`
- **–û—Ç–≤–µ—Ç**: HTML –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

### **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/admin/products`
- **–§–∞–π–ª**: `app/routers/web_products.py`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏

### **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/admin/orders`
- **–§–∞–π–ª**: `app/routers/web_orders.py`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏

### **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/admin/analytics`
- **–§–∞–π–ª**: `app/routers/web_analytics.py`
- **–û—Ç–≤–µ—Ç**: HTML —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π

---

## üì± –ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**
- **–ú–µ—Ç–æ–¥**: `GET`
- **–ü—É—Ç—å**: `/`
- **–§–∞–π–ª**: `app/main.py`
- **–§—É–Ω–∫—Ü–∏—è**: `root()`
- **–û—Ç–≤–µ—Ç**: HTML –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

---

## üîß API —Å—Ö–µ–º—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### **Swagger UI**
- **–ü—É—Ç—å**: `/docs`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
- **–û—Å–Ω–æ–≤–∞**: FastAPI OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è

### **OpenAPI JSON**
- **–ü—É—Ç—å**: `/openapi.json`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## üìã –°—Ö–µ–º—ã –æ—Ç–≤–µ—Ç–æ–≤

### **JSON –æ—Ç–≤–µ—Ç—ã (Shop API)**
```json
{
  "success": true,
  "message": "–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É",
  "cart_item_id": 123
}
```

### **HTML –æ—Ç–≤–µ—Ç—ã**
- **Content-Type**: `text/html`
- **–®–∞–±–ª–æ–Ω—ã**: Jinja2 templates
- **–ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω**: `shop/base.html`

---

## üîç –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–æ—É—Ç–µ—Ä—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã Shop API endpoints
- [x] –û–ø–∏—Å–∞–Ω—ã Web Shop –º–∞—Ä—à—Ä—É—Ç—ã
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ—Å—Ç–∞–≤–∫–∏
- [x] –û–ø–∏—Å–∞–Ω—ã QR-—Å–∫–∞–Ω–µ—Ä –∏ –∑–∞–∫–∞–∑—ã
- [x] –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
- [x] –£–∫–∞–∑–∞–Ω—ã —Ñ–∞–π–ª—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- [x] –û–ø–∏—Å–∞–Ω—ã —Å—Ö–µ–º—ã –æ—Ç–≤–µ—Ç–æ–≤
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–æ—É—Ç–µ—Ä–æ–≤*





